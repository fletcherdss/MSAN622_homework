<!DOCTYPE html>
<html lang="en">

<meta charset="utf-8">
<!-- <meta http-equiv="refresh" content="120" > <!-- for debugging only --> 
<style>


.axis { font: 10px sans-serif; }

.axis path,
.axis line {
  fill: #FFFFFF;
  stroke: black;
  shape-rendering: crispEdges;
}

.x.axis path {display: none;}
.y.axis path {display: black;}
.y.axis .tick line {stroke: lightgrey;}

.line {
  fill: none;
  stroke: steelblue;
  stroke-width: 1.5px;
}

 
</style>


<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Time Series Visualization</title>

<link href="css/bootstrap.min.css" rel="stylesheet">
<link href="css/bootstrap-theme.min.css" rel="stylesheet">

<style type="text/css">
    body {
        padding-top: 50px;
        padding-bottom: 20px;
    }
</style>

<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>

<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container">
        <div class="navbar-header">
		<button type="button" class="navbar-toggle collapsed" 
		    data-toggle="collapse" data-target="#navbar" 
		    aria-expanded="false" aria-controls="navbar">
			<span class="sr-only">Toggle Navigation</span>
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
		</button>
		<a class="navbar-brand" href="./#">MSAN 622</a>
        </div>
	
        <div id="navbar" class="navbar-collapse collapse">
		<ul class="nav navbar-nav">
			<li><a href="./#homework">Homework</a></li>
			<li><a href="./#project">Project</a></li>
			<li><a href="./#participation">Participation</a></li>
		</ul>
		
		<ul class="nav navbar-nav navbar-right">
			<li><a href="./#about">About</a></li>
			<li><a href="./#contact">Contact</a></li>
		</ul>
        </div><!--/.nav-collapse -->
    </div>
</nav>

<div class="col-md-4">
        <h2 class="page-header"><a name="featuresc"></a>A Simple Line Plot</h2>
        <p>
            This is a simple line plot showing the price of petrol (gasoline) 
            from 1969 to 1985. There is only a small amount of seasonal 
            behavior.
        </p>

</div>


<script src="js/d3.min.js" charset="utf-8"></script>
<script src="js/jquery.min.js" type="text/javascript"></script>
<script src="js/colorbrewer.js" type="text/javascript"></script>
<script>
 var margin = {top: 20, right: 20, bottom: 30, left: 40},
     width = 900 - margin.left - margin.right,
     height = 400 - margin.top - margin.bottom;

 var svg = d3.select("body").append("svg")
	         .attr("width", width + margin.left + margin.right)
	         .attr("height", height + margin.top + margin.bottom)
	         .append("g")
	         .attr("transform",
                   "translate(" + (margin.left) + "," + (margin.top) + ")");

 var showDate = function(time) {
     var year = Math.floor(time);
     var month = Math.floor((time - year) * 12) + 1;
     var months = ['Jan', 'Feb', 'March', 'April', 'May', 'Jun',
                   'Jul', 'Aug', 'Sep', 'Nov', 'Dec']
     return months[month] + " " + year;
 }

 d3.json("seatbelts.json", function (data) {
     var x = d3.scale.linear()
               .domain(d3.extent(data, function(d) {return d.time;}))
               .range([0,width]);

     var y = d3.scale.linear()
               .domain(d3.extent(data, function(d) {return d.PetrolPrice;}))
               .range([height, 0]);

     var line = d3.svg.line()
                  .x(function(d) { return x(d.time); })
                  .y(function(d) { return y(d.PetrolPrice); });
     
     svg.append("path")
        .datum(data)
        .attr("class", "line")
        .attr("d", line);

     var xAxis = d3.svg.axis().scale(x).orient("bottom").tickSize(6, 0 , 0);
     xAxis.tickFormat(d3.format("d"));
     var yAxis = d3.svg.axis().scale(y).orient("left").tickSize(6, 0, 0);

     var xax = svg.append("g").attr("class", "x axis")
                  .attr("transform", "translate(0," + height + ")")
	              .call(xAxis.ticks(15));

     xax.append("text")
	    .attr("y", 26)
	    .attr("x", width / 2 - 50)
	    .attr("dx", "0.71em")
	    .style("text-anchor", "end", " grid")
	    .text("year");

     var yax = svg.append("g")
                      .attr("class", "y axis")
                      .call(yAxis);
    
     yax.append("text")
	    .attr("y", 6)
	    .attr("x", -60)
	    .attr("transform", "rotate(-90)")
	    .attr("dy", "0.71em")
	    .style("text-anchor", "end", " grid")
	    .text("Petrol Price");
 });

</script>

<div class="col-md-4">
        <h2 class="page-header"><a name="featuresc"></a>A Stacked Area Plot</h2>
        <p>
            This stacked area plot shows passenger deaths in the front of the
            vehical and in the rear of the vehical.
        </p>
</div>

<script>

 var svg2 = d3.select("body").append("svg")
	         .attr("width", width + margin.left + margin.right)
	         .attr("height", height + margin.top + margin.bottom)
	         .append("g")
	         .attr("transform",
                   "translate(" + (margin.left) + "," + (margin.top) + ")");

 d3.json("seatbelts.json", function (data) {
     var x = d3.scale.linear()
               .domain(d3.extent(data, function(d) {return d.time;}))
               .range([0,width]);

     var y = d3.scale.linear()
               .domain([0, d3.max(data, function(d) {return d.front + d.rear;})])
               .range([height, 0]);

     
     var area = d3.svg.area()
                  .x(function(d) { return x(d.time); })
                  .y0(function(d) { return y(d.y0); })
                  .y1(function(d) { return y(d.y0 + d.y); });

     var stack = d3.layout.stack()
                   .values(function(d) { return d.values; });

     var color = d3.scale.category10()
                   .domain(['front', 'rear']);

     var stackData = stack(color.domain().map(function(name) {
         return {
             name: name,
             values: data.map(function(d) {
                 console.log(y(d[name]))
                 return {time: d.time, y: d[name]};
             })
         };
     }));

     var stackobj = svg2.selectAll(".stack")
                      .data(stackData)
                      .enter().append("g")
                      .attr("class", "stack");

     stackobj.append("path")
            .attr("class", "area")
            .attr("d", function(d) {return area(d.values);})
            .style("fill", function(d) { return color(d.name); });


     var xAxis = d3.svg.axis().scale(x).orient("bottom").tickSize(6, 0 , 0);
     xAxis.tickFormat(d3.format("d"));
     var yAxis = d3.svg.axis().scale(y).orient("left").tickSize(6, 0, 0);

     var xax = svg2.append("g").attr("class", "x axis")
                  .attr("transform", "translate(0," + height + ")")
	              .call(xAxis.ticks(15));

     xax.append("text")
	    .attr("y", 26)
	    .attr("x", width / 2 - 50)
	    .attr("dx", "0.71em")
	    .style("text-anchor", "end", " grid")
	    .text("year");

     var yax = svg2.append("g")
                      .attr("class", "y axis")
                      .call(yAxis);
    
     yax.append("text")
	    .attr("y", 6)
	    .attr("x", -105)
	    .attr("transform", "rotate(-90)")
	    .attr("dy", "0.71em")
	    .style("text-anchor", "end", " grid")
	    .text("Total Passenger Deaths");
 });

</script>
